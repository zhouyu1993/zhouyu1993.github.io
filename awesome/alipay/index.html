<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="cache-control" content="no-cache">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,viewport-fit=cover">
    <meta name="url" content="https://zhouyu1993.github.io/awesome/alipay/?qrcode=c1x08040rouaeb7ylydzj03">
    <title>你觉得我帅不帅？</title>
    <script src="https://open.mobile.qq.com/sdk/qqapi.js"></script>
    <style>
      body {
        margin: 0;
        -webkit-tap-highlight-color: transparent;
      }
      .openUrl {
        position: fixed;
        width: 100%;
        height: 100%;
        background-color: #fff;
        color: #121212;
        text-decoration: none;
      }
      h1 {
        text-align: center;
      }
      .button {
        position: fixed;
        top: 50%;
        left: 50%;
        width: 100px;
        height: 100px;
        margin-top: -50px;
        margin-left: -50px;
      }
      .button-item-1 {
        text-align: center;
        line-height: 50px;
        background-color: red;
      }
      .button-item-2 {
        margin-top: 20px;
        text-align: center;
        line-height: 50px;
        background-color: green;
      }
    </style>
  </head>
  <body>
    <a href="https://qr.alipay.com/c1x08040rouaeb7ylydzj03" class="openUrl">
      <h1>用QQ或QQ浏览器打开</h1>
      <h1>你觉得我帅不帅？</h1>
      <div class="button">
        <div class="button-item-1">
          帅！
        </div>
        <div class="button-item-2">
          不帅！
        </div>
      </div>
    </a>
    <script>
      if (/eruda=true/.test(window.location)) {
        document.write('<scr' + 'ipt src="https://cdn.jsdelivr.net/npm/eruda"></scr' + 'ipt>')
        document.write('<scr' + 'ipt>eruda.init();</scr' + 'ipt>')
      }
    </script>
    <script>
      var query = {}
      location.search.slice(1).split('&').forEach(function (v) {
        var arr = v.split('=')
        query[arr[0]] = arr[1]
      })
      var qrcode = query.qrcode || 'c1x08040rouaeb7ylydzj03'
      var url = 'https://qr.alipay.com/' + qrcode
      document.querySelector('.openUrl').setAttribute('href', url)

      function is_weixin () {
        if (/MicroMessenger/i.test(navigator.userAgent)) {
          return true
        } else {
          return false
        }
      }

      function is_qq () {
        var ua = navigator.userAgent.toLowerCase()
        if (ua.match(/(QQ)/i)) {
          return true
        } else {
          return false
        }
      }

      function is_android () {
        var ua = navigator.userAgent.toLowerCase()
        if (ua.match(/(Android|SymbianOS)/i)) {
          return true
        } else {
          return false
        }
      }

      function is_ios () {
        var ua = navigator.userAgent.toLowerCase()
        if (/iphone|ipad|ipod/.test(ua)) {
          return true
        } else {
          return false
        }
      }

      function android_auto_jump () {
        if (url !== '') {
          console.log('android', url)

          WeixinJSBridge.invoke('jumpToInstallUrl', {}, function (e) {
            console.log(e)
          })

          setTimeout(() => {
            mqq.invoke('ui', 'openUrl', {
              url: url,
              target: 2,
              style: 0
            })
          }, 500)

          setTimeout(() => {
            location.href = url
          }, 1000)
        } else {
          window.close()
          WeixinJSBridge.call('closeWindow')
        }
      }

      function ios_auto_jump () {
        if (url !== '') {
          console.log('ios', url)

          WeixinJSBridge.invoke('jumpToInstallUrl', {}, function (e) {
            console.log(e)
          })

          setTimeout(() => {
            mqq.invoke('ui', 'openUrl', {
              url: url,
              target: 2,
              style: 0
            })
          }, 500)

          setTimeout(() => {
            location.href = url
          }, 1000)
        } else {
          window.close()
          WeixinJSBridge.call('closeWindow')
        }
      }

      function onAutoinit () {
        if (is_android()) {
          android_auto_jump()
          return false
        }
        if (is_ios()) {
          ios_auto_jump()
          return false
        }
      }

      if (is_weixin()) {
        console.log('weixin', url)

        if (typeof WeixinJSBridge === 'undefined') {
          if (document.addEventListener) {
            document.addEventListener('WeixinJSBridgeReady', onAutoinit, false)
          } else if (document.attachEvent) {
            document.attachEvent('WeixinJSBridgeReady', onAutoinit)
            document.attachEvent('onWeixinJSBridgeReady', onAutoinit)
          }
        } else {
          onAutoinit()
        }
      } else if (is_qq()) {
        console.log('qq', url)

        setTimeout(() => {
          mqq.invoke('ui', 'openUrl', {
            url: url,
            target: 2,
            style: 0
          })
        }, 500)

      } else {
        if (url !== '') {
          location.href = url
        } else {
          window.close()
        }
      }
    </script>
  </body>
</html>
