(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-message-message"],{"0058":function(t,e,i){"use strict";var n=i("288e");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n(i("f499")),s={data:function(){return{position:[],button:[]}},computed:{pos:function(){return(0,a.default)(this.position)},btn:function(){return(0,a.default)(this.button)}},watch:{show:function(t){if(!this.autoClose){var e=this.position[0];e&&(e.show=t,this.$set(this.position,0,e))}}},mounted:function(){this.init(),this.getSize(),this.getButtonSize()},methods:{init:function(){var t=this;uni.$on("__uni__swipe__event",function(e){if(e!==t&&t.autoClose){var i=t.position[0];i.show=!1,t.$set(t.position,0,i)}})},openSwipe:function(){uni.$emit("__uni__swipe__event",this)},change:function(t){this.$emit("change",t.open);var e=this.position[0];e.show=t.open,this.$set(this.position,0,e)},onClick:function(t,e){this.$emit("click",{content:e,index:t})},getSize:function(){var t=this,e=uni.createSelectorQuery().in(this);e.selectAll(".selector-query-hock").boundingClientRect(function(e){t.autoClose?e[0].show=!1:e[0].show=t.show,t.position=e}).exec()},getButtonSize:function(){var t=this,e=uni.createSelectorQuery().in(this);e.selectAll(".button-hock").boundingClientRect(function(e){t.button=e}).exec()}}};e.default=s},"11d8":function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,".uni-swipe_content[data-v-0be9785a]{position:relative;width:100%;box-sizing:border-box;overflow:hidden}.uni-swipe_move-box[data-v-0be9785a]{position:relative;z-index:1;display:-webkit-box;display:-webkit-flex;display:flex;width:100%}.uni-swipe_box[data-v-0be9785a]{-webkit-flex-shrink:0;flex-shrink:0;width:100%;font-size:14px;color:#333;box-sizing:border-box;background:#fff;z-index:1}.uni-swipe_button-group[data-v-0be9785a]{\n\tdisplay:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex-shrink:0;flex-shrink:0;box-sizing:border-box}.uni-swipe_button[data-v-0be9785a]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center;padding:0 20px;font-size:14px;box-sizing:border-box}.ani[data-v-0be9785a]{-webkit-transition:-webkit-transform .35s cubic-bezier(.165,.84,.44,1);transition:-webkit-transform .35s cubic-bezier(.165,.84,.44,1);transition:transform .35s cubic-bezier(.165,.84,.44,1);transition:transform .35s cubic-bezier(.165,.84,.44,1),-webkit-transform .35s cubic-bezier(.165,.84,.44,1)}",""])},"2c5f":function(t,e,i){"use strict";var n=i("288e");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;n(i("ecaa"));var a=n(i("0058")),s={mixins:[a.default],props:{options:{type:Array,default:function(){return[]}},disabled:{type:Boolean,default:!1},show:{type:Boolean,default:!1},autoClose:{type:Boolean,default:!0}}};e.default=s},"2caa":function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */uni-page-body[data-v-590fcc8c]{background-color:#f5f5f5}.status-bar[data-v-590fcc8c]{background-color:#fff;position:fixed;left:0;top:0;z-index:9}.tabbar-menu[data-v-590fcc8c]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-box-align:center;-webkit-align-items:center;align-items:center;width:100%;background-color:#fff;border-bottom:%?1?% solid #f7f7f7;padding-top:0;position:fixed;left:0;top:0;z-index:9}.tabbar-menu .menu-list[data-v-590fcc8c]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-flex:1;-webkit-flex:1;flex:1;padding:0 %?20?%}.tabbar-menu .menu-list .menu-item[data-v-590fcc8c]{height:%?80?%;line-height:%?80?%;padding:0 %?20?%;font-size:%?30?%;text-align:center;color:#999;position:relative}.tabbar-menu .menu-list .menu-item.active[data-v-590fcc8c]{color:#ee3476}.tabbar-menu .menu-list .menu-item.active[data-v-590fcc8c]:after{content:"";width:%?20?%;height:%?10?%;background:#ee3476;border-radius:%?10?%;position:absolute;left:50%;bottom:0;margin-left:%?-10?%}.tabbar-menu .contact-wrap[data-v-590fcc8c]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center;height:%?80?%;padding:0 %?20?%}.tabbar-menu .contact-wrap .contact-icon[data-v-590fcc8c]{width:%?38?%;height:%?38?%;margin-right:%?10?%}.tabbar-menu .contact-wrap uni-text[data-v-590fcc8c]{font-size:%?30?%;color:#333}.tabbar-content[data-v-590fcc8c]{margin-top:0;padding-top:%?80?%}.search-wrap[data-v-590fcc8c]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-box-align:center;-webkit-align-items:center;align-items:center;margin:%?20?%;background:#fff;padding:0 %?40?% 0 %?20?%;border-radius:%?60?%}.search-wrap .uni-icon[data-v-590fcc8c]{font-size:%?36?%;color:#666}.search-wrap .input[data-v-590fcc8c]{-webkit-box-flex:1;-webkit-flex:1;flex:1;height:%?60?%;padding:0 %?10?%;box-sizing:border-box}.message-item[data-v-590fcc8c]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center;padding:%?20?%;background:#fff;border-bottom:1px solid #efefef}.message-item .avatar[data-v-590fcc8c]{width:%?100?%;height:%?100?%;border-radius:%?100?%}.message-item .message-data[data-v-590fcc8c]{-webkit-box-flex:1;-webkit-flex:1;flex:1;margin:0 %?10?%}.message-item .message-data .name[data-v-590fcc8c]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;font-size:%?30?%;color:#333}.message-item .message-data .content[data-v-590fcc8c]{font-size:%?24?%;color:#777}.message-item .message-info[data-v-590fcc8c]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;-webkit-box-pack:end;-webkit-justify-content:flex-end;justify-content:flex-end;-webkit-box-align:end;-webkit-align-items:flex-end;align-items:flex-end}.message-item .message-info .time[data-v-590fcc8c]{font-size:%?28?%;color:#777}.message-item .message-info .red-dot[data-v-590fcc8c]{width:%?20?%;height:%?20?%;background-color:red;border-radius:%?20?%;margin-top:%?10?%}.message-item .message-info .count[data-v-590fcc8c]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center;width:%?30?%;height:%?30?%;background-color:red;border-radius:%?30?%;font-size:%?16?%;color:#fff;margin-top:%?10?%}body.?%PAGE?%[data-v-590fcc8c]{background-color:#f5f5f5}',""])},"2eee":function(t,e,i){"use strict";var n=i("594b"),a=i.n(n);a.a},"315c":function(t,e,i){var n=i("2caa");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var a=i("4f06").default;a("658d66f2",n,!0,{sourceMap:!1,shadowMode:!1})},"325c":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"uni-swipe_content"},[i("v-uni-view",{wxsProps:{"change:prop":"pos"},staticClass:"uni-swipe_move-box selector-query-hock move-hock",attrs:{"data-disabled":t.disabled,"data-position":t.pos,"change:prop":t.swipe.sizeReady,prop:t.pos},on:{touchstart:function(e){e=t.$handleWxsEvent(e),t.swipe.touchstart(e,t.$getComponentDescriptor())},touchmove:function(e){e=t.$handleWxsEvent(e),t.swipe.touchmove(e,t.$getComponentDescriptor())},touchend:function(e){e=t.$handleWxsEvent(e),t.swipe.touchend(e,t.$getComponentDescriptor())},change:function(e){arguments[0]=e=t.$handleEvent(e),t.change.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"uni-swipe_box"},[t._t("default")],2),i("v-uni-view",{staticClass:"uni-swipe_button-group selector-query-hock move-hock"},t._l(t.options,function(e,n){return i("v-uni-view",{key:n,staticClass:"uni-swipe_button button-hock",style:{backgroundColor:e.style&&e.style.backgroundColor?e.style.backgroundColor:"#C7C6CD",color:e.style&&e.style.color?e.style.color:"#FFFFFF",fontSize:e.style&&e.style.fontSize?e.style.fontSize:"16px"},attrs:{"data-button":t.btn},on:{click:function(i){i.stopPropagation(),arguments[0]=i=t.$handleEvent(i),t.onClick(n,e)}}},[t._v(t._s(e.text))])}),1)],1)],1)},a=[];i.d(e,"a",function(){return n}),i.d(e,"b",function(){return a})},4276:function(t,e,i){"use strict";i.r(e);var n=i("b7d8"),a=i.n(n);for(var s in n)"default"!==s&&function(t){i.d(e,t,function(){return n[t]})}(s);e["default"]=a.a},"594b":function(t,e,i){var n=i("11d8");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var a=i("4f06").default;a("746981e3",n,!0,{sourceMap:!1,shadowMode:!1})},"66cf":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"content"},[i("v-uni-view",{staticClass:"status-bar"}),i("v-uni-view",{staticClass:"tabbar-wrap"},[i("v-uni-view",{staticClass:"tabbar-menu"},[i("v-uni-view",{staticClass:"menu-list"},t._l(t.tabBars,function(e,n){return i("v-uni-view",{key:e.id,class:["menu-item",t.tabIndex==n?"active":""],on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.tapTab(n)}}},[t._v(t._s(e.name))])}),1),i("v-uni-view",{staticClass:"contact-wrap",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.openContact.apply(void 0,arguments)}}},[i("v-uni-image",{staticClass:"contact-icon",attrs:{src:"/static/img/contact.png",mode:""}})],1)],1),i("v-uni-view",{staticClass:"tabbar-content"},[0==t.tabIndex?i("v-uni-view",{staticClass:"message-list"},[""!=t.admin.content?i("v-uni-view",{staticClass:"message-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.openIM(t.admin)}}},[i("v-uni-image",{staticClass:"avatar",attrs:{src:t.admin.avatar,mode:""}}),i("v-uni-view",{staticClass:"message-data"},[i("v-uni-view",{staticClass:"name"},[t._v(t._s(t.admin.name))]),i("v-uni-view",{staticClass:"content"},[t._v(t._s(t.admin.content))])],1),i("v-uni-view",{staticClass:"message-info"},[i("v-uni-view",{staticClass:"time"},[t._v(t._s(t._f("timeFormat")(t.admin.time)))]),t.admin.count>0?i("v-uni-view",{staticClass:"count"},[t._v(t._s(t.admin.count))]):t._e()],1)],1):t._e(),""!=t.visitor.id?i("v-uni-view",{staticClass:"message-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.openWin("visitor")}}},[i("v-uni-image",{staticClass:"avatar",attrs:{src:"/static/img/zuijinfangke.png",mode:""}}),i("v-uni-view",{staticClass:"message-data"},[i("v-uni-view",{staticClass:"name"},[t._v("最近访客")]),i("v-uni-view",{staticClass:"content"},[t._v(t._s(t.visitor.user.name)+"看了你")])],1),i("v-uni-view",{staticClass:"message-info"},[i("v-uni-view",{staticClass:"time"},[t._v(t._s(t._f("timeFormat")(t.visitor.created_at)))]),t.visitor_count>0?i("v-uni-view",{staticClass:"count"},[t._v(t._s(t.visitor_count))]):t._e()],1)],1):t._e(),""!=t.follow2.id?i("v-uni-view",{staticClass:"message-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.openWin("follow2")}}},[i("v-uni-image",{staticClass:"avatar",attrs:{src:"/static/img/xihuanwoderen.png",mode:""}}),i("v-uni-view",{staticClass:"message-data"},[i("v-uni-view",{staticClass:"name"},[t._v("喜欢我的人")]),i("v-uni-view",{staticClass:"content"},[t._v(t._s(t.follow2.member.name)+"赞了你")])],1),i("v-uni-view",{staticClass:"message-info"},[i("v-uni-view",{staticClass:"time"},[t._v(t._s(t._f("timeFormat")(t.follow2.created_at)))]),t.follow2_count>0?i("v-uni-view",{staticClass:"count"},[t._v(t._s(t.follow2_count))]):t._e()],1)],1):t._e(),""!=t.follow1.id?i("v-uni-view",{staticClass:"message-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.openWin("follow1")}}},[i("v-uni-image",{staticClass:"avatar",attrs:{src:"/static/img/woxihuanderen.png",mode:""}}),i("v-uni-view",{staticClass:"message-data"},[i("v-uni-view",{staticClass:"name"},[t._v("我喜欢的人")]),i("v-uni-view",{staticClass:"content"},[t._v("你赞了"+t._s(t.follow1.user.name))])],1),i("v-uni-view",{staticClass:"message-info"},[i("v-uni-view",{staticClass:"time"},[t._v(t._s(t._f("timeFormat")(t.follow1.created_at)))]),t.follow1_count>0?i("v-uni-view",{staticClass:"count"},[t._v(t._s(t.follow1_count))]):t._e()],1)],1):t._e(),t._l(t.c2cList,function(e,n){return i("uni-swipe-action",{key:n,attrs:{options:t.options},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.bindClick(e,n)}}},[i("v-uni-view",{staticClass:"message-item",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.openIM(e)}}},[i("v-uni-image",{staticClass:"avatar",attrs:{src:-1==e.avatar.indexOf("love-storage.uxiao.xin")?e.avatar:e.avatar+"?imageView2/1/w/100/h/100",mode:""}}),i("v-uni-view",{staticClass:"message-data"},[i("v-uni-view",{staticClass:"name"},[i("v-uni-text",[t._v(t._s(e.name))])],1),i("v-uni-view",{staticClass:"content"},[t._v(t._s(e.content))])],1),i("v-uni-view",{staticClass:"message-info"},[i("v-uni-view",{staticClass:"time"},[t._v(t._s(t._f("timeFormat")(e.time)))]),e.count>0?i("v-uni-view",{staticClass:"count"},[t._v(t._s(e.count))]):t._e()],1)],1)],1)}),""==t.admin.content&&0==t.c2cList.length?i("v-uni-view",{staticClass:"empty-wrap"},[i("v-uni-image",{staticClass:"empty-icon",attrs:{src:"/static/img/empty.png",mode:""}}),i("v-uni-text",{staticClass:"empty-text"},[t._v("暂无消息")])],1):t._e()],2):t._e(),1==t.tabIndex?i("v-uni-view",{staticClass:"message-list"},[""!=t.groupAdmin.content?i("v-uni-view",{staticClass:"message-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.openAdmin(t.groupAdmin)}}},[i("v-uni-image",{staticClass:"avatar",attrs:{src:t.groupAdmin.avatar,mode:""}}),i("v-uni-view",{staticClass:"message-data"},[i("v-uni-view",{staticClass:"name"},[t._v(t._s(t.groupAdmin.name))]),i("v-uni-view",{staticClass:"content"},[t._v(t._s(t.groupAdmin.content))])],1),i("v-uni-view",{staticClass:"message-info"},[i("v-uni-view",{staticClass:"time"},[t._v(t._s(t._f("timeFormat")(t.groupAdmin.time)))]),t.groupAdmin.count>0?i("v-uni-view",{staticClass:"count"},[t._v(t._s(t.groupAdmin.count))]):t._e()],1)],1):t._e(),t._l(t.groupList,function(e,n){return i("v-uni-view",{key:n,staticClass:"message-item",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.openGroup(e)}}},[i("v-uni-image",{staticClass:"avatar",attrs:{src:-1==e.avatar.indexOf("love-storage.uxiao.xin")?e.avatar:e.avatar+"?imageView2/1/w/100/h/100",mode:""}}),i("v-uni-view",{staticClass:"message-data"},[i("v-uni-view",{staticClass:"name"},[t._v(t._s(e.name))]),i("v-uni-view",{staticClass:"content"},[t._v(t._s(e.content))])],1),i("v-uni-view",{staticClass:"message-info"},[i("v-uni-view",{staticClass:"time"},[t._v(t._s(t._f("timeFormat")(e.time)))]),e.count>0?i("v-uni-view",{staticClass:"count"},[t._v(t._s(e.count))]):t._e()],1)],1)}),0==t.groupList.length?i("v-uni-view",{staticClass:"empty-wrap"},[i("v-uni-image",{staticClass:"empty-icon",attrs:{src:"/static/img/empty.png",mode:""}}),i("v-uni-text",{staticClass:"empty-text"},[t._v("暂无消息")])],1):t._e()],2):t._e()],1)],1)],1)},a=[];i.d(e,"a",function(){return n}),i.d(e,"b",function(){return a})},"7e9c":function(t,e,i){"use strict";var n=i("315c"),a=i.n(n);a.a},a4d4:function(t,e,i){"use strict";i.r(e);var n=i("66cf"),a=i("4276");for(var s in a)"default"!==s&&function(t){i.d(e,t,function(){return a[t]})}(s);i("7e9c");var o=i("f0c5"),c=Object(o["a"])(a["default"],n["a"],n["b"],!1,null,"590fcc8c",null);e["default"]=c.exports},a7bf:function(t,e,i){"use strict";var n=i("288e"),a=n(i("0a0d"));i("28a5");var s=n(i("59ad"));i("6b54");var o=n(i("e814"));function c(t){if("number"!==typeof t||t<0)return t;var e=(0,o.default)(t/3600);t%=3600;var i=(0,o.default)(t/60);t%=60;var n=t;return[e,i,n].map(function(t){return t=t.toString(),t[1]?t:"0"+t}).join(":")}function r(t,e){return"string"===typeof t&&"string"===typeof e&&(t=(0,s.default)(t),e=(0,s.default)(e)),t=t.toFixed(2),e=e.toFixed(2),{longitude:t.toString().split("."),latitude:e.toString().split(".")}}var l={UNITS:{"年":315576e5,"月":26298e5,"天":864e5,"小时":36e5,"分钟":6e4,"秒":1e3},humanize:function(t){var e="";for(var i in this.UNITS)if(t>=this.UNITS[i]){e=Math.floor(t/this.UNITS[i])+i+"前";break}return e||"刚刚"},format:function(t){var e=this.parse(t),i=(0,a.default)()-e.getTime();if(i<this.UNITS["天"])return this.humanize(i);var n=function(t){return t<10?"0"+t:t};return e.getFullYear()+"/"+n(e.getMonth()+1)+"/"+n(e.getDay())+"-"+n(e.getHours())+":"+n(e.getMinutes())},parse:function(t){var e=t.split(/[^0-9]/);return new Date(e[0],e[1]-1,e[2],e[3],e[4],e[5])}};t.exports={formatTime:c,formatLocation:r,dateUtils:l}},b7d8:function(t,e,i){"use strict";(function(t){var n=i("288e");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("a481"),i("6b54");var a=n(i("f499")),s=n(i("e814")),o=n(i("a7bf")),c=n(i("d104")),r={components:{uniSwipeAction:c.default},data:function(){return{userInfo:{},scrollLeft:0,tabIndex:0,tabBars:[{name:"消息",id:"message"},{name:"群组",id:"group"}],admin:{conversationID:"C2Cadmin",id:"admin",avatar:"/static/img/admin_msg.png",name:"系统消息",content:"",time:0,count:0},groupAdmin:{conversationID:"",id:"groupAdmin",avatar:"/static/img/admin_msg.png",name:"群通知消息",content:"",time:0,count:0},c2cList:[],groupList:[],visitor_list:[],visitor_count:0,visitor:{id:"",created_at:"2019-10-06 13:50:00",user:{name:""}},follow1_list:[],follow1_count:0,follow1:{id:"",created_at:(new Date).getTime(),user:{name:""}},follow2_list:[],follow2_count:0,follow2:{id:"",created_at:(new Date).getTime(),member:{name:""}},options:[{text:"删除",style:{backgroundColor:"rgb(255,58,49)"}}]}},onLoad:function(){var e=this;try{var i=uni.getStorageSync("user_info");i&&(this.userInfo=i)}catch(n){t.warn(n)}uni.$on("message-page",function(t){if(e.getRecentContactList(),t&&"message"==t.type&&"like"==t.data.payload.data){e.$tim.setMessageRead({conversationID:t.data.conversationID});var i=JSON.parse(t.data.payload.extension);t.data.to==e.userInfo.id&&e.follow2.member.id!=i.fromId&&(e.follow2.member.name=i.fromName,e.follow2.created_at=t.data.time,e.follow2_count=(0,s.default)(e.follow2_count)+1)}})},onReady:function(){},onPullDownRefresh:function(){var t=this;setTimeout(function(){t.getUserVisitor(),t.getUserFollow(1),t.getUserFollow(2),t.getRecentContactList()},500)},onShow:function(){t.log("message-page onShow"),this.getUserVisitor(),this.getUserFollow(1),this.getUserFollow(2),this.getRecentContactList()},onHide:function(){t.log("message-page onHide")},onUnload:function(){t.log("message-page onUnload")},methods:{bindClick:function(e,i){var n=this;this.$tim.deleteConversation(e.conversationID).then(function(e){t.log("被删除的会话 ID",e.data),n.c2cList.splice(i,1)}).catch(function(e){t.warn("删除会话失败",e)})},tapTab:function(t){if(this.tabIndex==t)return!1;this.tabIndex=t},openContact:function(){uni.navigateTo({url:"contact"})},getUserVisitor:function(){var t=this;this.$api.api.ajaxData({method:"V1.UserVisitor",uid:this.userInfo.id,token:this.userInfo.token,page:1},function(e){e.status&&e.data.list.length>0&&(t.visitor_list=e.data.list,t.visitor=e.data.list[0])})},getUserFollow:function(t){var e=this;this.$api.api.ajaxData({method:"V1.UserFollow",uid:this.userInfo.id,token:this.userInfo.token,type:t,page:1},function(i){i.status&&(1==t&&i.data.length>0&&(e.follow1_list=i.data,e.follow1=i.data[0]),2==t&&i.data.length>0&&(e.follow2_list=i.data,e.follow2=i.data[0]))})},openIM:function(t){uni.navigateTo({url:"im?to="+encodeURIComponent((0,a.default)(t))})},openWin:function(t){"visitor"==t&&(getApp().globalData.visitor_list=this.visitor_list),"follow1"==t&&(getApp().globalData.follow1_list=this.follow1_list),"follow2"==t&&(getApp().globalData.follow2_list=this.follow2_list,this.follow2_count=0),uni.navigateTo({url:t})},openAdmin:function(t){uni.navigateTo({url:"system?to="+(0,a.default)(t)})},openGroup:function(t){uni.navigateTo({url:"group_chat?to="+(0,a.default)(t)})},getRecentContactList:function(){var e=this,i=[],n=[];this.$tim.getConversationList().then(function(a){t.log("拉取会话列表",a),uni.stopPullDownRefresh();for(var s=a.data.conversationList,o=0,c=0;c<s.length;c++){if(o+=s[c].unreadCount,"C2C"==s[c].type){var r="";"TIMTextElem"==s[c].lastMessage.type&&(r=s[c].lastMessage.payload.text),"TIMCustomElem"==s[c].lastMessage.type&&("gift"!=s[c].lastMessage.payload.data&&"img"!=s[c].lastMessage.payload.data&&"voice"!=s[c].lastMessage.payload.data&&"addFriend"!=s[c].lastMessage.payload.data&&"like"!=s[c].lastMessage.payload.data||(r="["+s[c].lastMessage.payload.description+"]")),"admin"==s[c].userProfile.userID?(e.admin.time=s[c].lastMessage.lastTime,e.admin.count=s[c].unreadCount,e.admin.content=r):i.push({conversationID:s[c].conversationID,id:s[c].userProfile.userID,avatar:s[c].userProfile.avatar,name:s[c].userProfile.nick,content:r,time:s[c].lastMessage.lastTime,count:s[c].unreadCount})}if("GROUP"==s[c].type){var l="";"TIMTextElem"==s[c].lastMessage.type&&(l=s[c].lastMessage.payload.text),"TIMCustomElem"==s[c].lastMessage.type&&("gift"!=s[c].lastMessage.payload.data&&"img"!=s[c].lastMessage.payload.data&&"voice"!=s[c].lastMessage.payload.data||(l="["+s[c].lastMessage.payload.description+"]")),n.push({conversationID:s[c].conversationID,id:s[c].groupProfile.groupID,avatar:s[c].groupProfile.avatar?s[c].groupProfile.avatar:e.userInfo.avatar,name:s[c].groupProfile.name,content:l,time:s[c].lastMessage.lastTime,count:s[c].unreadCount})}"@TIM#SYSTEM"==s[c].type&&"TIMGroupSystemNoticeElem"==s[c].lastMessage.type&&(e.groupAdmin.conversationID=s[c].conversationID,e.groupAdmin.time=s[c].lastMessage.lastTime,e.groupAdmin.count=s[c].unreadCount,e.groupAdmin.content="群通知")}e.c2cList=i,e.groupList=n,0==o?uni.removeTabBarBadge({index:3}):uni.setTabBarBadge({index:3,text:o.toString()})}).catch(function(e){t.warn("获取会话列表失败",e)})},getGroupList:function(){var e=this;this.$tim.getGroupList().then(function(i){t.log("获取群组列表",(0,a.default)(i.data.groupList));for(var n=0;n<i.data.groupList.length;n++)for(var s=0;s<e.groupList.length;s++)if(i.data.groupList[n].groupID!=e.groupList[s].id){e.groupList.push({conversationID:"GROUP"+i.data.groupList[n].groupID,id:i.data.groupList[n].groupID,avatar:i.data.groupList[n].avatar?i.data.groupList[n].avatar:e.userInfo.avatar,name:i.data.groupList[n].name,content:"",time:i.data.groupList[n].selfInfo.joinTime,count:0});break}}).catch(function(e){t.warn("获取群组列表失败的相关信息",e)})}},filters:{timeFormat:function(t){var e=(new Date).getTime(),i=t,n=0;return"number"===typeof t&&(n=1e3*i),"string"===typeof t&&(n=new Date(t.replace(/-/g,"/")).getTime()),o.default.dateUtils.humanize(e-n)}}};e.default=r}).call(this,i("5a52")["default"])},bed5:function(t,e,i){"use strict";i.r(e);var n=i("2c5f"),a=i.n(n);for(var s in n)"default"!==s&&function(t){i.d(e,t,function(){return n[t]})}(s);e["default"]=a.a},d104:function(t,e,i){"use strict";i.r(e);var n=i("325c"),a=i("bed5");for(var s in a)"default"!==s&&function(t){i.d(e,t,function(){return a[t]})}(s);i("2eee");var o=i("f0c5"),c=i("e489"),r=Object(o["a"])(a["default"],n["a"],n["b"],!1,null,"0be9785a",null);"function"===typeof c["a"]&&Object(c["a"])(r),e["default"]=r.exports},e489:function(t,e,i){"use strict";var n=function(t){(t.options.wxs||(t.options.wxs={}))["swipe"]=function(t){function e(t,e,i,n){var a=n.getState();if(a.position=JSON.parse(n.getDataset().position),0!==a.position.length){var s=a.position[0].show;a.left=a.left||a.position[0].left,r(!!s,n,i)}}function i(t,e){var i=t.instance,n=i.getState(),a=t.touches[0].pageX;i.removeClass("ani");for(var s=e.selectAllComponents(".button-hock"),o=0;o<s.length;o++)s[o].removeClass("ani");n.position=JSON.parse(i.getDataset().position),n.left=n.left||n.position[0].left,n.width=a-n.left,e.callMethod("openSwipe")}function n(t,e){var i=t.instance,n=i.getDataset().disabled,a=i.getState();if(!n){var o=t.touches[0].pageX;s(o-a.width,i,e)}}function a(t,e){var i=t.instance,n=i.getDataset().disabled,a=i.getState();n||o(a.left,-40,i,e)}function s(t,e,i){var n=e.getState(),a=Math.max(-n.position[1].width,Math.min(t,0));n.left=a,e.setStyle({transform:"translateX("+a+"px)","-webkit-transform":"translateX("+a+"px)"}),c(a,e,i)}function o(t,e,i,n){var a=i.getState(),s=a.position,o=a.isopen;s[1].width?o?-t<=s[1].width?r(!1,i,n):r(!0,i,n):r(t<=e,i,n):r(!1,i,n)}function c(t,e,i){for(var n=i.selectAllComponents(".button-hock"),a=e.getState(),s=a.position,o=[],c=0,r=0;r<n.length;r++){if(!n[r].getDataset().button)return;var l=JSON.parse(n[r].getDataset().button),u=l[r]&&l[r].width||0;c+=u,o.push(-c);var f=o[r-1]+t*(o[r-1]/s[1].width);0!=r&&n[r].setStyle({transform:"translateX("+f+"px)"})}}function r(t,e,i){var n=e.getState(),a=n.position;n.isopen=t,i.callMethod("change",{open:t}),e.addClass("ani");for(var o=i.selectAllComponents(".button-hock"),c=0;c<o.length;c++)o[c].addClass("ani");s(t?-a[1].width:0,e,i)}return t.exports={sizeReady:e,touchstart:i,touchmove:n,touchend:a},t.exports}({exports:{}})};e["a"]=n},ecaa:function(t,e,i){"use strict";var n=i("288e");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n(i("e814")),s={data:function(){return{uniShow:!1,left:0}},computed:{moveLeft:function(){return"translateX(".concat(this.left,"px)")}},watch:{show:function(t){this.autoClose||(t?(this.$emit("change",!0),this.open()):(this.$emit("change",!1),this.close()),uni.$emit("__uni__swipe__event",this))}},onReady:function(){this.init(),this.getSelectorQuery()},beforeDestoy:function(){uni.$off("__uni__swipe__event")},methods:{init:function(){var t=this;uni.$on("__uni__swipe__event",function(e){e!==t&&t.autoClose&&0!==t.left&&t.close()})},onClick:function(t,e){this.$emit("click",{content:e,index:t})},touchstart:function(t){var e=t.touches[0].pageX;if(!this.disabled){var i=this.position[0].left;uni.$emit("__uni__swipe__event",this),this.width=e-i,this.isopen||this.uniShow&&(this.uniShow=!1,this.isopen=!0,this.openleft=this.left+this.position[1].width)}},touchmove:function(t,e){if(!this.disabled){var i=t.touches[0].pageX;this.setPosition(i)}},touchend:function(){this.disabled||(this.isopen?this.move(this.openleft,0):this.move(this.left,-40))},setPosition:function(t,e){this.position[1].width&&(this.left=t-this.width,this.setValue(t-this.width))},setValue:function(t){this.left=Math.max(-this.position[1].width,Math.min((0,a.default)(t),0)),this.position[0].left=this.left,this.isopen&&(this.openleft=this.left+this.position[1].width)},move:function(t,e){t>=e?(this.$emit("change",!1),this.close()):(this.$emit("change",!0),this.open())},open:function(){this.uniShow=!0,this.left=-this.position[1].width,this.setValue(-this.position[1].width)},close:function(){var t=this;this.uniShow=!0,this.setValue(0),setTimeout(function(){t.uniShow=!1,t.isopen=!1},200)},getSelectorQuery:function(){var t=this,e=uni.createSelectorQuery().in(this);e.selectAll(".selector-query-hock").boundingClientRect(function(e){t.position=e,t.autoClose||(t.show?t.open():t.close())}).exec()}}};e.default=s}}]);