(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-my-avatar"],{"034c":function(n,i,e){"use strict";var t=e("ce02"),a=e.n(t);a.a},"094f":function(n,i,e){"use strict";(function(n){var t=e("288e");Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=t(e("f499"));e("28a5");var o=t(e("9f05")),u={data:function(){return{userInfo:{},form:{file:""},avatar:"",qiniuToken:"",domain:"",progress:0}},onLoad:function(n){this.userInfo=JSON.parse(n.userinfo),this.avatar=this.userInfo.avatar},onReady:function(){uni.hideTabBar(),this.getQiniuToken()},onNavigationBarButtonTap:function(n){if(""==this.form.file)return uni.showToast({title:"请上传头像",position:"bottom",icon:"none"}),!1;uni.showLoading({title:""}),this.$api.api.ajaxData({method:"V1.UserUpload",uid:this.userInfo.id,token:this.userInfo.token,type:"3",file:this.form.file},function(n){uni.hideLoading(),uni.showToast({title:n.msg,position:"bottom",icon:"none"}),n.status&&(uni.$emit("my-page",{type:"update"}),uni.navigateBack({delta:1}))})},methods:{getQiniuToken:function(){var n=this;this.$api.api.ajaxData({method:"V1.QiniuToken",uid:this.userInfo.id,token:this.userInfo.token},function(i){i.status&&(n.qiniuToken=i.data.token,n.domain=i.data.domain)})},upload:function(i){var e=this;uni.chooseImage({count:1,sizeType:["original","compressed"],sourceType:[i],success:function(i){var t=i.tempFilePaths[0].split("/");uni.showLoading({title:e.progress+"%"}),o.default.upload(i.tempFilePaths[0],function(n){uni.hideLoading(),e.avatar=i.tempFilePaths[0],e.form.file=n.key},function(i){n.log("err: "+(0,a.default)(i))},{region:"SCN",domain:e.domain,key:t[t.length-1],uptoken:e.qiniuToken},function(n){e.progress=n.progress},function(){},function(){},function(){})}})},previewImage:function(){""!=this.avatar&&uni.previewImage({current:0,urls:[this.avatar],indicator:"none",loop:!1})}}};i.default=u}).call(this,e("5a52")["default"])},"2bb5":function(n,i,e){"use strict";e.r(i);var t=e("531f"),a=e("d1f26");for(var o in a)"default"!==o&&function(n){e.d(i,n,function(){return a[n]})}(o);e("034c");var u=e("f0c5"),r=Object(u["a"])(a["default"],t["a"],t["b"],!1,null,"515a38f5",null);i["default"]=r.exports},"531f":function(n,i,e){"use strict";var t=function(){var n=this,i=n.$createElement,e=n._self._c||i;return e("v-uni-view",{staticClass:"content"},[e("v-uni-view",{staticClass:"tips"},[n._v("上传本人真实的个人正脸照")]),e("v-uni-view",{staticClass:"avatar-wrap"},[e("v-uni-image",{staticClass:"avatar",attrs:{src:n.avatar,mode:"aspectFill"},on:{click:function(i){arguments[0]=i=n.$handleEvent(i),n.previewImage.apply(void 0,arguments)}}})],1),e("v-uni-view",{staticClass:"btn-wrap"},[e("v-uni-button",{staticClass:"album",attrs:{type:"primary"},on:{click:function(i){arguments[0]=i=n.$handleEvent(i),n.upload("album")}}},[n._v("本地上传")]),e("v-uni-button",{staticClass:"camera",attrs:{type:"default"},on:{click:function(i){arguments[0]=i=n.$handleEvent(i),n.upload("camera")}}},[n._v("拍照上传")])],1)],1)},a=[];e.d(i,"a",function(){return t}),e.d(i,"b",function(){return a})},"7f8a":function(n,i,e){i=n.exports=e("2350")(!1),i.push([n.i,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */uni-page-body[data-v-515a38f5]{background:#f5f5f5}.tips[data-v-515a38f5]{font-size:%?28?%;color:#333;text-align:center;margin:%?50?%}.avatar-wrap[data-v-515a38f5]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.avatar-wrap .avatar[data-v-515a38f5]{width:%?360?%;height:%?360?%;border-radius:%?10?%}.btn-wrap[data-v-515a38f5]{margin:%?50?%;padding:0 %?50?%}.btn-wrap uni-button[data-v-515a38f5]{border-radius:%?100?%}.btn-wrap uni-button+uni-button[data-v-515a38f5]{margin-top:%?20?%}.btn-wrap uni-button.camera[data-v-515a38f5]{border:%?1?% solid #ff76a8;color:#ff76a8}body.?%PAGE?%[data-v-515a38f5]{background:#f5f5f5}',""])},"9f05":function(n,i,e){"use strict";(function(i){e("28a5"),function(){var e={qiniuRegion:"",qiniuImageURLPrefix:"",qiniuUploadToken:"",qiniuUploadTokenURL:"",qiniuUploadTokenFunction:null,qiniuShouldUseQiniuFileName:!1};function t(n){e={qiniuRegion:"",qiniuImageURLPrefix:"",qiniuUploadToken:"",qiniuUploadTokenURL:"",qiniuUploadTokenFunction:null,qiniuShouldUseQiniuFileName:!1},a(n)}function a(n){n.region?e.qiniuRegion=n.region:i.error("qiniu uploader need your bucket region"),n.uptoken?e.qiniuUploadToken=n.uptoken:n.uptokenURL?e.qiniuUploadTokenURL=n.uptokenURL:n.uptokenFunc&&(e.qiniuUploadTokenFunction=n.uptokenFunc),n.domain&&(e.qiniuImageURLPrefix=n.domain),e.qiniuShouldUseQiniuFileName=n.shouldUseQiniuFileName}function o(n,t,o,s,l,c,f,p){if(null!=n)if(s&&a(s),e.qiniuUploadToken)u(n,t,o,s,l,c,f,p);else if(e.qiniuUploadTokenURL)r(function(){u(n,t,o,s,l,c,f,p)});else{if(!e.qiniuUploadTokenFunction)return void i.error("qiniu uploader need one of [uptoken, uptokenURL, uptokenFunc]");if(e.qiniuUploadToken=e.qiniuUploadTokenFunction(),null==e.qiniuUploadToken&&e.qiniuUploadToken.length>0)return void i.error("qiniu UploadTokenFunction result is null, please check the return value");u(n,t,o,s,l,c,f,p)}else i.error("qiniu uploader need filePath to upload")}function u(n,t,a,o,u,r,l,c){if(null==e.qiniuUploadToken&&e.qiniuUploadToken.length>0)i.error("qiniu UploadToken is null, please check the init config or networking");else{var f=s(e.qiniuRegion),p=n.split("//")[1];o&&o.key&&(p=o.key);var d={token:e.qiniuUploadToken};e.qiniuShouldUseQiniuFileName||(d["key"]=p),l&&l();var k=wx.uploadFile({url:f,filePath:n,name:"file",formData:d,success:function(n){var o=n.data;try{var u=JSON.parse(o),r=e.qiniuImageURLPrefix+"/"+u.key;u.fileUrl=r,u.imageURL=r,t&&t(u)}catch(s){i.log(s),i.log("parse JSON failed, origin String is: "+o),a&&a(s)}},fail:function(n){i.error(n),a&&a(n)},complete:function(n){c&&c(n)}});k.onProgressUpdate(function(n){u&&u(n)}),r&&r(function(){k.abort()})}}function r(n){wx.request({url:e.qiniuUploadTokenURL,success:function(t){var a=t.data.uptoken;a&&a.length>0?(e.qiniuUploadToken=a,n&&n()):i.error("qiniuUploader cannot get your token, please check the uptokenURL or server")},fail:function(n){i.error("qiniu UploadToken is null, please check the init config or networking: "+n)}})}function s(n){var e=null;switch(n){case"ECN":e="http://up.qiniup.com";break;case"NCN":e="https://up-z1.qiniup.com";break;case"SCN":e="https://up-z2.qiniup.com";break;case"NA":e="https://up-na0.qiniup.com";break;case"ASG":e="https://up-as0.qiniup.com";break;default:i.error("please make the region is with one of [ECN, SCN, NCN, NA, ASG]")}return e}n.exports={init:t,upload:o}}()}).call(this,e("5a52")["default"])},ce02:function(n,i,e){var t=e("7f8a");"string"===typeof t&&(t=[[n.i,t,""]]),t.locals&&(n.exports=t.locals);var a=e("4f06").default;a("9e91abb8",t,!0,{sourceMap:!1,shadowMode:!1})},d1f26:function(n,i,e){"use strict";e.r(i);var t=e("094f"),a=e.n(t);for(var o in t)"default"!==o&&function(n){e.d(i,n,function(){return t[n]})}(o);i["default"]=a.a}}]);